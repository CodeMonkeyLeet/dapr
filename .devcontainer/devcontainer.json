{
	"name": "Dapr Tutorial Codespace",

	// TODO: Replace local docker image reference when image is published to registry
	// "image": "docker.io/daprio/dapr-tutorial:0.1.0",
	"build": {
		"dockerfile": "../docker/Dockerfile-tutorial",
		"context": "../docker"
	},
	"runArgs": [
		// Enable ptrace-based debugging for Go in container
		"--cap-add=SYS_PTRACE",
		"--security-opt",
		"seccomp=unconfined",

		// Enable docker-in-docker configuration
		"--init",
		"--privileged",
	],
	"settings": {
		"terminal.integrated.defaultProfile.linux": "bash",
		"go.toolsManagement.checkForUpdates": "local",
		"go.useLanguageServer": true,
		"go.gopath": "/go",
		"go.goroot": "/usr/local/go"
	},
	// To use this devcontainer locally, permit the docker group RW access to /var/run/docker.sock
	// e.g. chgrp docker /var/run/docker.sock && chmod 660 /var/run/docker.sock
	"mounts": [
		"source=codespaces-linux-var-lib-docker,target=/var/lib/docker,type=volume",
		"source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"
	],
	"extensions": [
		"ms-vscode.go",
		"ms-azuretools.vscode-docker",
		"ms-kubernetes-tools.vscode-kubernetes-tools",
		"ms-azuretools.vscode-dapr"
	],
	// Connect to codespace as non-root user. See https://aka.ms/vscode-remote/containers/non-root.
	"remoteUser": "codespace"
}
